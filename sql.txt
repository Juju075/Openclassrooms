CREATE SCHEMA IF NOT EXISTS `app_blog_mvc` DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci ;


CREATE TABLE IF NOT EXISTS `app_blog_mvc`.`article` ( 
	id_article           int  NOT NULL  AUTO_INCREMENT  PRIMARY KEY,
	title                varchar(255)  NOT NULL    ,
	content              longtext  NOT NULL    ,
	`updatedAt`          datetime      ,
	chapo                varchar(255)  NOT NULL    ,
	`createdAt`          datetime  NOT NULL DEFAULT CURRENT_TIMESTAMP   ,
	id_user              int   
 ) ENGINE=InnoDB;
--
--
--

CREATE TABLE IF NOT EXISTS `app_blog_mvc`.`comment` (
	id_comment           int  NOT NULL  AUTO_INCREMENT  PRIMARY KEY,
	content              text  NOT NULL    ,
	createdat            datetime  NOT NULL DEFAULT CURRENT_TIMESTAMP   ,
	disabled             int  NOT NULL DEFAULT 1   ,
	id_article           int      ,
	id_user              int    
 ) ENGINE=InnoDB;
--
--
--
CREATE TABLE IF NOT EXISTS `app_blog_mvc`.`messaging` (
	id_messaging         int  NOT NULL  AUTO_INCREMENT  PRIMARY KEY,
	title                int      ,
	message              int      ,
	id_user              int  NOT NULL    ,
	createdat            datetime  NOT NULL   
 ) ENGINE=InnoDB;
--
--
--
CREATE TABLE IF NOT EXISTS `app_blog_mvc`.`user` (
	id_user              int  NOT NULL  AUTO_INCREMENT  PRIMARY KEY,
	username             varchar(50)  NOT NULL    ,
	email                varchar(100)  NOT NULL    ,
	password             varchar(255)  NOT NULL    ,
	activated            boolean  NOT NULL    ,
	validation_key       varchar(50)  NOT NULL    ,
	usertype             boolean  NOT NULL    ,
	avatar               varchar(255)  NOT NULL    ,
	`createdAt`          datetime  NOT NULL DEFAULT CURRENT_TIMESTAMP   ,
	prenom               varchar(255)  NOT NULL    ,
	nom                  varchar(255)  NOT NULL    ,
	`updatedAt`          datetime  
 ) ENGINE=InnoDB;

ALTER TABLE app_blog_mvc.avatar ADD CONSTRAINT fk_avatar_user FOREIGN KEY ( id_avatar ) REFERENCES app_blog_mvc.`user`( id_user ) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE app_blog_mvc.comment ADD CONSTRAINT fk_comment_article_0 FOREIGN KEY ( id_article ) REFERENCES app_blog_mvc.article( id_article ) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE app_blog_mvc.comment ADD CONSTRAINT fk_comment_user FOREIGN KEY ( id_user ) REFERENCES app_blog_mvc.`user`( id_user ) ON DELETE RESTRICT ON UPDATE RESTRICT;

ALTER TABLE app_blog_mvc.messaging ADD CONSTRAINT fk_messaging_user FOREIGN KEY ( id_user ) REFERENCES app_blog_mvc.`user`( id_user ) ON DELETE RESTRICT ON UPDATE RESTRICT;

INSERT INTO app_blog_mvc.article( id_article, title, content, `updatedAt`, chapo, `createdAt`, id_user ) VALUES ( 39, 'Article 1', 'le contenu de mon article 1', '2020-09-20 11.00.00 PM', 'Mon chapeau 1', '2021-09-20 10.28.21 PM', 0);
INSERT INTO app_blog_mvc.article( id_article, title, content, `updatedAt`, chapo, `createdAt`, id_user ) VALUES ( 45, 'fsfsdfsd', 'sdfsfsdfsdf', null, 'dfsfdsdf', '2021-09-21 06.03.12 PM', null);
INSERT INTO app_blog_mvc.article( id_article, title, content, `updatedAt`, chapo, `createdAt`, id_user ) VALUES ( 46, 'dfgdgdf', 'dfgdgdfg', null, 'dfgdgdf', '2021-09-22 05.09.31 PM', null);
INSERT INTO app_blog_mvc.article( id_article, title, content, `updatedAt`, chapo, `createdAt`, id_user ) VALUES ( 47, 'dfgdgdf', 'dfgdgdfg', null, 'dfgdgdf', '2021-09-22 05.10.02 PM', null);
INSERT INTO app_blog_mvc.article( id_article, title, content, `updatedAt`, chapo, `createdAt`, id_user ) VALUES ( 48, 'zerze', 'zerze', null, 'zerze', '2021-09-22 05.21.59 PM', null);
INSERT INTO app_blog_mvc.`user`( id_user, username, email, password, activated, validation_key, usertype, avatar, `createdAt`, prenom, nom, `updatedAt` ) VALUES ( 11, 'testutilisateur', 'testemail@gmail.com', '$2y$10$NoKCkMeVJQRP6tDGzPELgu6SAUWOGYRkcs6UkLLZ8ELKl0okj2QHS', 1, '123456', 1, 'default_avatar.jpg', '2021-09-10 05.52.11 PM', 'testprenom', 'testnom', null);
INSERT INTO app_blog_mvc.`user`( id_user, username, email, password, activated, validation_key, usertype, avatar, `createdAt`, prenom, nom, `updatedAt` ) VALUES ( 12, 'testusername', 'testuser@user.com', '$2y$10$xx9/qZiszTLxl8CkcKcyaOXXKnrtXISfpajqPkGNMS4MKysi9VLFu', 1, '123456', 1, 'default_avatar.jpg', '2021-09-10 09.13.00 PM', 'testprenom', 'testnom', null);
INSERT INTO app_blog_mvc.`user`( id_user, username, email, password, activated, validation_key, usertype, avatar, `createdAt`, prenom, nom, `updatedAt` ) VALUES ( 13, 'sfsf', 'sfsfsfs@moi.fr', '$2y$10$UGh.9FOT9XYNb3tvcz/flOTbYktUIv.hbEyVxcjhfP2OpKoY8eLX.', 1, '123456', 1, 'default_avatar.jpg', '2021-09-21 12.03.03 AM', 'sfsf', 'sfsf', null);
INSERT INTO app_blog_mvc.comment( id_comment, content, createdat, disabled, id_article, id_user ) VALUES ( 2, 'fzefzefzezerz', '2021-09-21 08.53.59 PM', 1, null, null);
INSERT INTO app_blog_mvc.comment( id_comment, content, createdat, disabled, id_article, id_user ) VALUES ( 3, 'commentaire', '2021-09-22 05.54.27 PM', 1, null, null);
INSERT INTO app_blog_mvc.comment( id_comment, content, createdat, disabled, id_article, id_user ) VALUES ( 4, 'nouveau commentaire', '2021-09-22 05.54.39 PM', 1, null, null);
INSERT INTO app_blog_mvc.comment( id_comment, content, createdat, disabled, id_article, id_user ) VALUES ( 5, 'nouveau commentaire', '2021-09-22 05.55.52 PM', 1, null, null);
INSERT INTO app_blog_mvc.comment( id_comment, content, createdat, disabled, id_article, id_user ) VALUES ( 6, 'nouveau commentaire', '2021-09-22 06.01.03 PM', 1, null, null);
INSERT INTO app_blog_mvc.comment( id_comment, content, createdat, disabled, id_article, id_user ) VALUES ( 7, 'dernier commentaire', '2021-09-22 06.01.41 PM', 1, null, null);
INSERT INTO app_blog_mvc.comment( id_comment, content, createdat, disabled, id_article, id_user ) VALUES ( 8, 'zouzoul le commentaire', '2021-09-22 06.03.40 PM', 1, null, null);